name: Persistent 12-Hour SSH VM

on:
  workflow_dispatch:
  schedule:
    - cron: "0 */6 * * *"  # Every 6 hours

jobs:
  start-vm:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup SSHX and Rclone
        run: |
          sudo apt update
          sudo apt install -y curl unzip
          curl -sSf https://sshx.io/get | sh -s run &
          curl https://rclone.org/install.sh | sudo bash
          echo "SSHX is running. Connect and run: rclone config"

      - name: Sleep
        run: sleep 43200  # Keeps job alive for 12 hours

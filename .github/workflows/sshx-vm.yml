name: Launch SSHX VM

on:
  workflow_dispatch:

jobs:
  sshx-vm:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Create disk folder
      run: mkdir -p vmdata

    - name: Download and install sshx
      run: |
        curl -L https://s3.amazonaws.com/sshx/sshx-x86_64-unknown-linux-musl.tar.gz -o sshx.tar.gz
        mkdir sshx-bin
        tar -xzf sshx.tar.gz -C sshx-bin
        sudo mv sshx-bin/sshx /usr/local/bin/sshx
        sshx --version

    - name: Start SSHX VM
      run: |
        sshx --name ptero-vm --image ubuntu:22.04 --enable-readers &
        sleep 15
        echo "âœ… VM launched. Open the SSHX link in your terminal output!"

name: Launch SSHX VM

on:
  workflow_dispatch:

jobs:
  sshx-vm:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Create disk folder
      run: mkdir -p vmdata

    - name: Install sshx
      run: |
        curl -sL https://sshx.io/get -o sshx-install.sh
        chmod +x sshx-install.sh
        ./sshx-install.sh
        sudo mv sshx*/sshx /usr/local/bin/sshx
        sshx --version

    - name: Start SSHX VM
      run: |
        sshx --name ptero-vm --image ubuntu:22.04 --enable-readers &
        sleep 10
        echo "VM launched! You can now SSH into it using the provided link."
